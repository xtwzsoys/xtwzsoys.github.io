<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>51单片机函数学习指南 | 从入门到精通</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Source+Code+Pro:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36CFC9',
                        accent: '#FF7D00',
                        dark: '#1D2129',
                        light: '#F2F3F5'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Source Code Pro', 'monospace']
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .transition-transform {
                transition-property: transform;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 300ms;
            }
            .comic-border {
                border: 3px solid #333;
                border-radius: 15px;
                box-shadow: 4px 4px 0 #000;
            }
            .code-step {
                opacity: 0;
                transform: translateY(10px);
                transition: all 0.5s ease;
            }
            .code-step.active {
                opacity: 1;
                transform: translateY(0);
            }
            .led {
                width: 20px;
                height: 20px;
                border-radius: 50%;
                background-color: #333;
                display: inline-block;
                margin: 0 5px;
                transition: background-color 0.3s ease;
            }
            .led.on {
                background-color: #FF7D00;
                box-shadow: 0 0 10px #FF7D00;
            }
        }
    </style>
    
    <style>
        /* 代码高亮样式 */
        .code-block {
            position: relative;
            overflow-x: auto;
        }
        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .code-block:hover .copy-btn {
            opacity: 1;
        }
        
        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }
        
        /* 动画效果 */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .comic-speech {
            position: relative;
            background: white;
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .comic-speech:after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 30px;
            border-width: 15px 15px 0;
            border-style: solid;
            border-color: white transparent;
        }
        
        /* 平滑滚动 */
        html {
            scroll-behavior: smooth;
        }
        
        /* 代码演示动画 */
        .demo-container {
            position: relative;
            min-height: 200px;
        }
        
        /* 函数调用动画 */
        .function-call-animation {
            animation: callFunction 1s ease-out forwards;
        }
        @keyframes callFunction {
            0% { transform: translateX(0); opacity: 1; }
            50% { transform: translateX(50px); opacity: 0.5; }
            100% { transform: translateX(100px); opacity: 0; }
        }
        
        .function-return-animation {
            animation: returnFunction 1s ease-out forwards;
            animation-delay: 1s;
        }
        @keyframes returnFunction {
            0% { transform: translateX(100px); opacity: 0; }
            50% { transform: translateX(50px); opacity: 0.5; }
            100% { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>

<body class="bg-gray-50 font-sans text-dark">
    <!-- 导航栏 -->
    <header id="navbar" class="fixed w-full bg-white/95 shadow-sm z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <i class="fa fa-microchip text-primary text-2xl"></i>
                <h1 class="text-xl font-bold text-primary">51单片机函数学习</h1>
            </div>
            
            <!-- 桌面导航 -->
            <nav class="hidden md:flex items-center space-x-6">
                <a href="#what-is" class="text-gray-600 hover:text-primary transition-colors">什么是函数</a>
                <a href="#structure" class="text-gray-600 hover:text-primary transition-colors">函数结构</a>
                <a href="#usage" class="text-gray-600 hover:text-primary transition-colors">使用方法</a>
                <a href="#examples" class="text-gray-600 hover:text-primary transition-colors">实例演示</a>
                <a href="#practice" class="text-gray-600 hover:text-primary transition-colors">练习</a>
            </nav>
            
            <!-- 移动端菜单按钮 -->
            <button id="menu-toggle" class="md:hidden text-gray-600 focus:outline-none">
                <i class="fa fa-bars text-xl"></i>
            </button>
        </div>
        
        <!-- 移动端导航菜单 -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100 px-4 py-2">
            <a href="#what-is" class="block py-2 text-gray-600 hover:text-primary">什么是函数</a>
            <a href="#structure" class="block py-2 text-gray-600 hover:text-primary">函数结构</a>
            <a href="#usage" class="block py-2 text-gray-600 hover:text-primary">使用方法</a>
            <a href="#examples" class="block py-2 text-gray-600 hover:text-primary">实例演示</a>
            <a href="#practice" class="block py-2 text-gray-600 hover:text-primary">练习</a>
        </div>
    </header>

    <!-- 英雄区域 -->
    <section class="pt-28 pb-16 bg-gradient-to-br from-primary/5 to-secondary/5">
        <div class="container mx-auto px-4">
            <div class="max-w-3xl mx-auto text-center">
                <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-dark mb-6 leading-tight text-shadow">
                    轻松掌握51单片机<span class="text-primary">函数</span>编程
                </h1>
                <p class="text-lg text-gray-600 mb-8">
                    从基础概念到实际应用，一步步教你理解函数的本质，学会编写和使用函数，让你的单片机程序更简洁、更高效。
                </p>
                <a href="#what-is" class="inline-flex items-center px-6 py-3 bg-primary text-white rounded-lg shadow-md hover:bg-primary/90 transition-all transform hover:-translate-y-1 pulse">
                    开始学习 <i class="fa fa-arrow-down ml-2"></i>
                </a>
            </div>
        </div>
    </section>

    <main class="container mx-auto px-4 py-12">
        <!-- 什么是函数 -->
        <section id="what-is" class="mb-20 scroll-mt-24">
            <div class="max-w-4xl mx-auto">
                <div class="flex items-center mb-6">
                    <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center mr-4">
                        <i class="fa fa-question-circle text-primary text-xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold">什么是函数？</h2>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <!-- 文字解释区 -->
                    <div class="flex flex-col md:flex-row gap-8 mb-8 items-center">
                        <div class="w-full md:w-1/2">
                            <div class="comic-border bg-white p-4">
                                <div class="comic-speech mt-2">
                                    <p class="font-bold">函数就像自动售货机！</p>
                                    <p>投入参数（钱），得到返回值（饮料）</p>
                                </div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2">
                            <p class="text-gray-700 mb-6 leading-relaxed">
                                在51单片机编程中，<span class="font-semibold text-primary">函数</span>就像是一个"小工具"或"子程序"，它是一段具有特定功能的代码块。
                            </p>
                            
                            <div class="bg-light rounded-lg p-6 mb-6 border-l-4 border-primary">
                                <p class="text-gray-700">
                                    想象你有一个常用的操作，比如让LED闪烁3次。与其每次需要这个功能时都重新编写代码，不如把这段代码放进一个函数里，以后只需要"调用"这个函数就可以了。
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-4">函数的好处</h3>
                    <div class="grid md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-light p-4 rounded-lg transform transition-transform hover:scale-105">
                            <div class="flex items-center mb-2">
                                <i class="fa fa-code text-primary mr-2"></i>
                                <h4 class="font-medium">代码简洁</h4>
                            </div>
                            <p class="text-sm text-gray-600">避免重复编写相同代码，减少程序体积</p>
                        </div>
                        <div class="bg-light p-4 rounded-lg transform transition-transform hover:scale-105">
                            <div class="flex items-center mb-2">
                                <i class="fa fa-refresh text-primary mr-2"></i>
                                <h4 class="font-medium">便于维护</h4>
                            </div>
                            <p class="text-sm text-gray-600">修改函数一处，所有调用处都生效</p>
                        </div>
                        <div class="bg-light p-4 rounded-lg transform transition-transform hover:scale-105">
                            <div class="flex items-center mb-2">
                                <i class="fa fa-users text-primary mr-2"></i>
                                <h4 class="font-medium">团队协作</h4>
                            </div>
                            <p class="text-sm text-gray-600">多人开发时，各自负责不同函数</p>
                        </div>
                    </div>
                    
                    <!-- 函数概念动画演示 -->
                    <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6">
                        <h4 class="font-semibold mb-4 text-center">函数工作原理演示</h4>
                        <div class="demo-container flex flex-col items-center">
                            <div class="w-full max-w-md bg-white p-4 border border-gray-300 rounded mb-4 flex justify-between">
                                <div>
                                    <p class="font-medium">主程序</p>
                                    <p class="text-sm text-gray-600">需要完成：LED闪烁3次</p>
                                </div>
                                <button id="start-demo" class="bg-primary text-white px-3 py-1 rounded text-sm">
                                    开始演示
                                </button>
                            </div>
                            
                            <div class="flex items-center justify-center w-full gap-8">
                                <div class="text-center">
                                    <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-2 mx-auto" id="main-program">
                                        <span class="font-bold">主程序</span>
                                    </div>
                                    <p class="text-sm">Main</p>
                                </div>
                                
                                <div class="text-center">
                                    <div class="w-24 h-24 bg-primary/10 rounded-full flex items-center justify-center mb-2 mx-auto" id="function-box">
                                        <span class="font-bold text-primary">LED闪烁函数</span>
                                    </div>
                                    <p class="text-sm">ledBlink()</p>
                                </div>
                                
                                <div class="text-center">
                                    <div class="mb-2">
                                        <span class="led" id="led1"></span>
                                        <span class="led" id="led2"></span>
                                        <span class="led" id="led3"></span>
                                    </div>
                                    <p class="text-sm">LED指示灯</p>
                                </div>
                            </div>
                            
                            <div class="mt-4 text-sm text-gray-500" id="demo-status">
                                点击"开始演示"按钮观看函数调用过程
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 函数结构 -->
        <section id="structure" class="mb-20 scroll-mt-24">
            <div class="max-w-4xl mx-auto">
                <div class="flex items-center mb-6">
                    <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center mr-4">
                        <i class="fa fa-cubes text-primary text-xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold">函数的基本结构</h2>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <div class="flex flex-col md:flex-row gap-8 mb-8">
                        <div class="w-full md:w-1/2">
                            <p class="text-gray-700 mb-6">
                                51单片机C语言中的函数通常由以下几个部分组成，就像写一篇文章要有标题、正文和结尾一样：
                            </p>
                            
                            <div class="comic-border bg-white p-4 mb-6">
                                <div class="comic-speech">
                                    <p class="font-bold">函数就像一道菜的食谱！</p>
                                    <ul class="list-disc pl-5 text-sm">
                                        <li>返回值类型 = 成品菜（如宫保鸡丁）</li>
                                        <li>函数名 = 菜名（如"制作宫保鸡丁"）</li>
                                        <li>参数 = 食材（鸡肉、花生米等）</li>
                                        <li>函数体 = 烹饪步骤</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="w-full md:w-1/2">
                            <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm mb-6">
                                <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                <pre><span class="text-green-400">// 函数定义格式</span>
<span class="text-yellow-300">返回值类型</span> <span class="text-blue-300">函数名</span>(<span class="text-purple-300">参数列表</span>)
{
    <span class="text-gray-300">// 函数体：具体执行的代码</span>
    <span class="text-orange-300">return</span> <span class="text-gray-300">返回值;</span> <span class="text-green-400">// 如果有返回值的话</span>
}</pre>
                            </div>
                            
                            <!-- 交互式函数结构演示 -->
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <p class="text-center font-medium mb-3">点击各部分查看说明</p>
                                <div class="function-structure">
                                    <div class="function-part mb-2 p-2 border border-gray-200 rounded cursor-pointer hover:bg-primary/5" data-part="return-type">
                                        <span class="text-yellow-600 font-mono">返回值类型</span>
                                    </div>
                                    <div class="function-part mb-2 p-2 border border-gray-200 rounded cursor-pointer hover:bg-primary/5" data-part="name">
                                        <span class="text-blue-600 font-mono">函数名</span>
                                    </div>
                                    <div class="function-part mb-2 p-2 border border-gray-200 rounded cursor-pointer hover:bg-primary/5" data-part="parameters">
                                        <span class="text-purple-600 font-mono">(参数列表)</span>
                                    </div>
                                    <div class="function-part mb-2 p-2 border border-gray-200 rounded cursor-pointer hover:bg-primary/5" data-part="body">
                                        <span class="text-gray-600 font-mono">{ 函数体 }</span>
                                    </div>
                                    <div class="function-part p-2 border border-gray-200 rounded cursor-pointer hover:bg-primary/5" data-part="return">
                                        <span class="text-orange-600 font-mono">return 返回值;</span>
                                    </div>
                                </div>
                                <div class="mt-4 p-3 bg-white border border-gray-200 rounded" id="part-explanation">
                                    点击上面的函数部分查看详细说明
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-light rounded-lg p-6 border-l-4 border-accent">
                        <h4 class="font-semibold mb-2 flex items-center">
                            <i class="fa fa-lightbulb-o text-accent mr-2"></i> 小贴士
                        </h4>
                        <p class="text-gray-700 text-sm">
                            在51单片机编程中，最常用的函数类型是无返回值无参数的函数<code class="bg-white px-1 py-0.5 rounded text-primary">void 函数名(void)</code>，以及带参数的延时函数等。
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 函数使用方法 -->
        <section id="usage" class="mb-20 scroll-mt-24">
            <div class="max-w-4xl mx-auto">
                <div class="flex items-center mb-6">
                    <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center mr-4">
                        <i class="fa fa-play-circle text-primary text-xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold">函数的使用方法</h2>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <p class="text-gray-700 mb-6">
                        使用函数通常分为三个步骤：声明、定义和调用。就像使用一个工具，首先要告诉别人有这个工具（声明），然后做出这个工具（定义），最后才能使用它（调用）。
                    </p>
                    
                    <!-- 步骤动画演示 -->
                    <div class="mb-10">
                        <div class="flex justify-center mb-8">
                            <div class="flex items-center w-full max-w-2xl">
                                <div class="flex-1 text-center">
                                    <div class="w-16 h-16 rounded-full bg-primary text-white flex items-center justify-center mx-auto mb-2 step-circle" data-step="1">
                                        <span class="font-bold">1</span>
                                    </div>
                                    <p class="font-medium">声明</p>
                                </div>
                                <div class="w-16 h-0.5 bg-gray-300 flex-shrink-0"></div>
                                <div class="flex-1 text-center">
                                    <div class="w-16 h-16 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center mx-auto mb-2 step-circle" data-step="2">
                                        <span class="font-bold">2</span>
                                    </div>
                                    <p class="font-medium">定义</p>
                                </div>
                                <div class="w-16 h-0.5 bg-gray-300 flex-shrink-0"></div>
                                <div class="flex-1 text-center">
                                    <div class="w-16 h-16 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center mx-auto mb-2 step-circle" data-step="3">
                                        <span class="font-bold">3</span>
                                    </div>
                                    <p class="font-medium">调用</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 步骤内容 -->
                        <div class="step-content" id="step-1">
                            <h3 class="text-xl font-semibold mb-4">步骤1：函数声明（声明原型）</h3>
                            <p class="text-gray-600 mb-4">
                                告诉编译器有这么一个函数存在，通常放在程序的开头，main函数之前。
                            </p>
                            <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm mb-4">
                                <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                <pre><span class="text-green-400">// 函数声明示例：声明一个让LED闪烁的函数</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">ledBlink</span>(<span class="text-yellow-300">int</span> <span class="text-purple-300">times</span>); <span class="text-green-400">// 注意末尾有分号</span></pre>
                            </div>
                        </div>
                        
                        <div class="step-content hidden" id="step-2">
                            <h3 class="text-xl font-semibold mb-4">步骤2：函数定义（实现函数）</h3>
                            <p class="text-gray-600 mb-4">
                                具体编写函数的功能代码，说明这个函数是如何工作的。
                            </p>
                            <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm mb-4">
                                <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                <pre><span class="text-green-400">// 函数定义：实现LED闪烁指定次数</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">ledBlink</span>(<span class="text-yellow-300">int</span> <span class="text-purple-300">times</span>)
{
    <span class="text-yellow-300">int</span> i;
    <span class="text-green-400">// 循环times次</span>
    <span class="text-orange-300">for</span>(i = 0; i < times; i++)
    {
        P1 = 0x00; <span class="text-green-400">// LED亮</span>
        delay(500); <span class="text-green-400">// 延时500ms</span>
        P1 = 0xFF; <span class="text-green-400">// LED灭</span>
        delay(500); <span class="text-green-400">// 延时500ms</span>
    }
}</pre>
                            </div>
                        </div>
                        
                        <div class="step-content hidden" id="step-3">
                            <h3 class="text-xl font-semibold mb-4">步骤3：函数调用（使用函数）</h3>
                            <p class="text-gray-600 mb-4">
                                在需要使用函数功能的地方，通过函数名来调用它。
                            </p>
                            <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm mb-4">
                                <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                <pre><span class="text-green-400">// 在main函数中调用ledBlink函数</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">main</span>(<span class="text-yellow-300">void</span>)
{
    <span class="text-green-400">// 让LED闪烁3次</span>
    <span class="text-blue-300">ledBlink</span>(3); <span class="text-green-400">// 调用函数，传入参数3</span>
    
    <span class="text-green-400">// 程序暂停在这里</span>
    <span class="text-orange-300">while</span>(1);
}</pre>
                            </div>
                        </div>
                        
                        <div class="flex justify-center gap-4 mt-6">
                            <button id="prev-step" class="bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                上一步
                            </button>
                            <button id="next-step" class="bg-primary text-white px-4 py-2 rounded hover:bg-primary/90 transition-colors">
                                下一步
                            </button>
                        </div>
                    </div>
                    
                    <!-- 函数调用动画演示 -->
                    <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6">
                        <h4 class="font-semibold mb-4 text-center">函数调用流程动画</h4>
                        <div class="flex flex-col md:flex-row gap-4 items-center justify-center">
                            <div class="w-32 h-16 bg-gray-100 rounded flex items-center justify-center border-2 border-gray-300">
                                <span class="font-medium">主程序</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div id="call-arrow" class="w-16 h-8 text-gray-400 hidden">
                                    <i class="fa fa-long-arrow-right text-2xl"></i>
                                </div>
                                <div id="return-arrow" class="w-16 h-8 text-gray-400 hidden rotate-180">
                                    <i class="fa fa-long-arrow-right text-2xl"></i>
                                </div>
                            </div>
                            <div class="w-32 h-16 bg-primary/10 rounded flex items-center justify-center border-2 border-primary/30">
                                <span class="font-medium text-primary">ledBlink()</span>
                            </div>
                        </div>
                        <div class="mt-4 text-center">
                            <button id="animate-call" class="bg-primary text-white px-4 py-2 rounded text-sm">
                                演示函数调用
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-light rounded-lg p-6 border-l-4 border-accent">
                        <h4 class="font-semibold mb-2 flex items-center">
                            <i class="fa fa-exclamation-circle text-accent mr-2"></i> 注意事项
                        </h4>
                        <ul class="text-gray-700 text-sm space-y-2">
                            <li>• 函数必须先声明或定义，才能被调用</li>
                            <li>• 调用函数时，参数的类型和数量要与声明/定义时一致</li>
                            <li>• 函数可以在其他函数内部被调用，包括在另一个函数内部</li>
                            <li>• 51单片机的函数不能嵌套定义（不能在一个函数内部定义另一个函数）</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- 实例演示 -->
        <section id="examples" class="mb-20 scroll-mt-24">
            <div class="max-w-4xl mx-auto">
                <div class="flex items-center mb-6">
                    <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center mr-4">
                        <i class="fa fa-laptop text-primary text-xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold">实例演示</h2>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <p class="text-gray-700 mb-8">
                        下面是几个51单片机中常用的函数实例，你可以点击展开查看详细代码和说明，还有交互式演示哦！
                    </p>
                    
                    <!-- 实例1：延时函数 -->
                    <div class="mb-8 border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-light px-6 py-4 flex justify-between items-center cursor-pointer example-header" data-target="example1">
                            <h3 class="font-semibold text-lg">实例1：毫秒级延时函数</h3>
                            <i class="fa fa-chevron-down text-primary transition-transform duration-300"></i>
                        </div>
                        <div id="example1" class="hidden p-6 border-t border-gray-200">
                            <p class="text-gray-600 mb-4">
                                延时函数是51单片机编程中最常用的函数之一，用于控制程序的执行节奏，比如让LED闪烁一定时间。
                            </p>
                            
                            <!-- 代码分步演示 -->
                            <div class="mb-6">
                                <div class="flex justify-between items-center mb-2">
                                    <p class="font-medium">代码分步讲解</p>
                                    <div>
                                        <button id="prev-code-1" class="bg-gray-200 text-gray-700 px-2 py-1 rounded text-xs mr-1 disabled:opacity-50 disabled:cursor-not-allowed" disabled>上一步</button>
                                        <button id="next-code-1" class="bg-primary text-white px-2 py-1 rounded text-xs">下一步</button>
                                    </div>
                                </div>
                                <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm">
                                    <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                    <pre>
<span class="code-step" data-step="1"><span class="text-green-400">// 1. 函数声明：声明一个毫秒级延时函数</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayMs</span>(<span class="text-yellow-300">unsigned int</span> <span class="text-purple-300">ms</span>);</span>

<span class="code-step" data-step="2"><span class="text-green-400">// 2. 函数定义：实现毫秒级延时</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayMs</span>(<span class="text-yellow-300">unsigned int</span> <span class="text-purple-300">ms</span>)
{</span>

<span class="code-step" data-step="3">    <span class="text-yellow-300">unsigned int</span> i, j;
    <span class="text-orange-300">for</span>(i = 0; i < ms; i++)  <span class="text-green-400">// 循环ms次</span>
        <span class="text-orange-300">for</span>(j = 0; j < 112; j++); <span class="text-green-400">// 内部循环，大约1ms</span>
}</span>

<span class="code-step" data-step="4"><span class="text-green-400">// 3. 主函数中调用</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">main</span>(<span class="text-yellow-300">void</span>)
{
    <span class="text-orange-300">while</span>(1)  <span class="text-green-400">// 无限循环</span>
    {</span>

<span class="code-step" data-step="5">        P1 = 0x00; <span class="text-green-400">// P1口输出低电平，LED亮</span>
        delayMs(500); <span class="text-green-400">// 延时500ms</span>
        P1 = 0xFF; <span class="text-green-400">// P1口输出高电平，LED灭</span>
        delayMs(500); <span class="text-green-400">// 延时500ms</span>
    }
}</span>
                                    </pre>
                                </div>
                                <div class="mt-2 p-3 bg-gray-50 rounded border border-gray-200 text-sm" id="code-explanation-1">
                                    点击"下一步"开始查看代码分步讲解
                                </div>
                            </div>
                            
                            <!-- 延时函数演示 -->
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4">
                                <h4 class="font-medium mb-3">延时函数效果演示</h4>
                                <div class="flex flex-col items-center">
                                    <div class="mb-4">
                                        <span class="led" id="demo-led-1"></span>
                                    </div>
                                    <div class="flex items-center gap-4 mb-4">
                                        <label for="delay-time">延时时间：</label>
                                        <input type="range" id="delay-time" min="100" max="2000" value="500" class="w-40">
                                        <span id="delay-value">500</span> ms
                                    </div>
                                    <button id="start-delay-demo" class="bg-primary text-white px-4 py-2 rounded text-sm">
                                        开始演示
                                    </button>
                                </div>
                            </div>
                            
                            <div class="bg-light p-4 rounded-lg text-sm text-gray-700">
                                <p class="font-medium mb-1">代码说明：</p>
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>这是一个带参数的void类型函数，参数ms表示要延时的毫秒数</li>
                                    <li>通过两层for循环实现延时，内部循环次数根据单片机主频调整</li>
                                    <li>在main函数的while(1)循环中，调用delayMs函数控制LED闪烁频率</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 实例2：LED控制函数 -->
                    <div class="mb-8 border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-light px-6 py-4 flex justify-between items-center cursor-pointer example-header" data-target="example2">
                            <h3 class="font-semibold text-lg">实例2：LED控制函数</h3>
                            <i class="fa fa-chevron-down text-primary transition-transform duration-300"></i>
                        </div>
                        <div id="example2" class="hidden p-6 border-t border-gray-200">
                            <p class="text-gray-600 mb-4">
                                这个实例展示了如何编写控制LED亮灭的函数，可以指定具体哪个LED以及亮灭状态。
                            </p>
                            
                            <!-- 交互式LED演示 -->
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6">
                                <h4 class="font-medium mb-3">LED控制演示</h4>
                                <div class="mb-4">
                                    <div class="flex justify-center gap-2 mb-2">
                                        <div class="text-center">
                                            <span class="led" id="led-0"></span>
                                            <p class="text-xs mt-1">LED 0</p>
                                        </div>
                                        <div class="text-center">
                                            <span class="led" id="led-1"></span>
                                            <p class="text-xs mt-1">LED 1</p>
                                        </div>
                                        <div class="text-center">
                                            <span class="led" id="led-2"></span>
                                            <p class="text-xs mt-1">LED 2</p>
                                        </div>
                                        <div class="text-center">
                                            <span class="led" id="led-3"></span>
                                            <p class="text-xs mt-1">LED 3</p>
                                        </div>
                                        <div class="text-center">
                                            <span class="led" id="led-4"></span>
                                            <p class="text-xs mt-1">LED 4</p>
                                        </div>
                                        <div class="text-center">
                                            <span class="led" id="led-5"></span>
                                            <p class="text-xs mt-1">LED 5</p>
                                        </div>
                                        <div class="text-center">
                                            <span class="led" id="led-6"></span>
                                            <p class="text-xs mt-1">LED 6</p>
                                        </div>
                                        <div class="text-center">
                                            <span class="led" id="led-7"></span>
                                            <p class="text-xs mt-1">LED 7</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex flex-wrap gap-4 justify-center">
                                        <div>
                                            <label for="led-select">选择LED：</label>
                                            <select id="led-select" class="border border-gray-300 rounded px-2 py-1">
                                                <option value="0">0</option>
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option>
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <button id="led-on" class="bg-green-500 text-white px-3 py-1 rounded text-sm">点亮</button>
                                            <button id="led-off" class="bg-gray-500 text-white px-3 py-1 rounded text-sm ml-1">熄灭</button>
                                        </div>
                                        
                                        <div>
                                            <button id="led-sequence" class="bg-primary text-white px-3 py-1 rounded text-sm">流水灯效果</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm mb-4">
                                <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                <pre><span class="text-green-400">// 函数声明</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayMs</span>(<span class="text-yellow-300">unsigned int</span> ms);
<span class="text-yellow-300">void</span> <span class="text-blue-300">ledControl</span>(<span class="text-yellow-300">unsigned char</span> ledNum, <span class="text-yellow-300">bit</span> state);

<span class="text-green-400">// 延时函数定义</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayMs</span>(<span class="text-yellow-300">unsigned int</span> ms)
{
    <span class="text-yellow-300">unsigned int</span> i, j;
    <span class="text-orange-300">for</span>(i = 0; i < ms; i++)
        <span class="text-orange-300">for</span>(j = 0; j < 112; j++);
}

<span class="text-green-400">// LED控制函数定义</span>
<span class="text-green-400">// ledNum: LED编号(0-7)，state: 状态(1-亮，0-灭)</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">ledControl</span>(<span class="text-yellow-300">unsigned char</span> ledNum, <span class="text-yellow-300">bit</span> state)
{
    <span class="text-green-400">// 检查LED编号是否合法</span>
    <span class="text-orange-300">if</span>(ledNum > 7)
        <span class="text-orange-300">return</span>; <span class="text-green-400">// 不合法则退出函数</span>
    
    <span class="text-green-400">// 根据状态控制LED</span>
    <span class="text-orange-300">if</span>(state)
        P1 &= ~(1 << ledNum); <span class="text-green-400">// 对应位清0，LED亮</span>
    <span class="text-orange-300">else</span>
        P1 |= (1 << ledNum);  <span class="text-green-400">// 对应位置1，LED灭</span>
}

<span class="text-green-400">// 主函数</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">main</span>(<span class="text-yellow-300">void</span>)
{
    P1 = 0xFF; <span class="text-green-400">// 初始化LED为灭</span>
    
    <span class="text-orange-300">while</span>(1)
    {
        <span class="text-green-400">// 依次点亮LED0到LED7</span>
        <span class="text-orange-300">for</span>(<span class="text-yellow-300">unsigned char</span> i = 0; i < 8; i++)
        {
            ledControl(i, 1); <span class="text-green-400">// 点亮第i个LED</span>
            delayMs(300);
            ledControl(i, 0); <span class="text-green-400">// 熄灭第i个LED</span>
        }
    }
}</pre>
                            </div>
                            <div class="bg-light p-4 rounded-lg text-sm text-gray-700">
                                <p class="font-medium mb-1">代码说明：</p>
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>ledControl函数有两个参数：ledNum(LED编号)和state(状态)</li>
                                    <li>使用位操作来控制特定的LED，1 << ledNum用于定位到具体的LED位</li>
                                    <li>在main函数中，通过for循环和调用ledControl函数实现LED流水灯效果</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 实例3：带返回值的函数 -->
                    <div class="mb-8 border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-light px-6 py-4 flex justify-between items-center cursor-pointer example-header" data-target="example3">
                            <h3 class="font-semibold text-lg">实例3：带返回值的函数</h3>
                            <i class="fa fa-chevron-down text-primary transition-transform duration-300"></i>
                        </div>
                        <div id="example3" class="hidden p-6 border-t border-gray-200">
                            <p class="text-gray-600 mb-4">
                                这个实例展示了如何编写带返回值的函数，以一个简单的温度转换函数为例。
                            </p>
                            
                            <!-- 温度转换交互演示 -->
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6">
                                <h4 class="font-medium mb-3">温度转换演示</h4>
                                <div class="flex flex-col md:flex-row gap-6 items-center">
                                    <div class="w-full md:w-1/2">
                                        <label for="celsius-input" class="block mb-1">摄氏度 (°C):</label>
                                        <input type="number" id="celsius-input" value="20" min="-50" max="100" class="w-full border border-gray-300 rounded px-3 py-2 mb-2">
                                        <button id="convert-btn" class="bg-primary text-white px-4 py-2 rounded text-sm">
                                            转换为华氏度
                                        </button>
                                    </div>
                                    <div class="w-full md:w-1/2">
                                        <div class="comic-border bg-white p-4 text-center">
                                            <p class="text-sm mb-1">转换结果</p>
                                            <p class="text-3xl font-bold text-primary" id="fahrenheit-result">68.0 °F</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm mb-4">
                                <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                <pre><span class="text-green-400">// 函数声明</span>
<span class="text-yellow-300">float</span> <span class="text-blue-300">celsiusToFahrenheit</span>(<span class="text-yellow-300">float</span> celsius);
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayMs</span>(<span class="text-yellow-300">unsigned int</span> ms);

<span class="text-green-400">// 延时函数</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayMs</span>(<span class="text-yellow-300">unsigned int</span> ms)
{
    <span class="text-yellow-300">unsigned int</span> i, j;
    <span class="text-orange-300">for</span>(i = 0; i < ms; i++)
        <span class="text-orange-300">for</span>(j = 0; j < 112; j++);
}

<span class="text-green-400">// 摄氏度转华氏度函数</span>
<span class="text-green-400">// 返回值：转换后的华氏度</span>
<span class="text-yellow-300">float</span> <span class="text-blue-300">celsiusToFahrenheit</span>(<span class="text-yellow-300">float</span> celsius)
{
    <span class="text-yellow-300">float</span> fahrenheit;
    fahrenheit = celsius * 9 / 5 + 32; <span class="text-green-400">// 转换公式</span>
    <span class="text-orange-300">return</span> fahrenheit; <span class="text-green-400">// 返回转换结果</span>
}

<span class="text-green-400">// 假设的读取温度函数（实际中会连接传感器）</span>
<span class="text-yellow-300">float</span> <span class="text-blue-300">readTemperature</span>(<span class="text-yellow-300">void</span>)
{
    <span class="text-green-400">// 这里简化处理，实际中会从温度传感器读取</span>
    <span class="text-orange-300">static</span> <span class="text-yellow-300">float</span> temp = 20.0;
    temp += 0.5;
    <span class="text-orange-300">if</span>(temp > 30.0) temp = 20.0;
    <span class="text-orange-300">return</span> temp;
}

<span class="text-green-400">// 主函数</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">main</span>(<span class="text-yellow-300">void</span>)
{
    <span class="text-yellow-300">float</span> cTemp, fTemp;
    
    <span class="text-orange-300">while</span>(1)
    {
        cTemp = readTemperature(); <span class="text-green-400">// 读取摄氏度</span>
        fTemp = celsiusToFahrenheit(cTemp); <span class="text-green-400">// 转换为华氏度</span>
        
        <span class="text-green-400">// 这里可以添加显示代码，将温度显示在LCD上</span>
        
        delayMs(1000); <span class="text-green-400">// 1秒更新一次</span>
    }
}</pre>
                            </div>
                            <div class="bg-light p-4 rounded-lg text-sm text-gray-700">
                                <p class="font-medium mb-1">代码说明：</p>
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>celsiusToFahrenheit函数接收一个float类型的参数（摄氏度），返回转换后的华氏度</li>
                                    <li>函数的返回值类型是float，与return语句后面的变量类型一致</li>
                                    <li>在main函数中，我们将函数的返回值赋给变量fTemp，以便后续使用</li>
                                    <li>这种带返回值的函数常用于数据转换、计算等场景</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 练习题 -->
        <section id="practice" class="mb-20 scroll-mt-24">
            <div class="max-w-4xl mx-auto">
                <div class="flex items-center mb-6">
                    <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center mr-4">
                        <i class="fa fa-pencil text-primary text-xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold">练习题</h2>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <p class="text-gray-700 mb-8">
                        尝试完成以下练习题，巩固所学的函数知识。点击"查看答案"可以看到参考实现。
                    </p>
                    
                    <!-- 练习1 -->
                    <div class="mb-8 border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-light px-6 py-4 flex justify-between items-center cursor-pointer practice-header" data-target="practice1">
                            <h3 class="font-semibold text-lg">练习1：编写一个蜂鸣器发声函数</h3>
                            <i class="fa fa-chevron-down text-primary transition-transform duration-300"></i>
                        </div>
                        <div id="practice1" class="hidden p-6 border-t border-gray-200">
                            <div class="flex flex-col md:flex-row gap-6 mb-6">
                                <div class="w-full md:w-1/2">
                                    <p class="text-gray-600 mb-4">
                                        任务：编写一个控制蜂鸣器发声的函数，要求函数可以指定发声频率和持续时间。
                                    </p>
                                    <div class="bg-light p-4 rounded-lg mb-4">
                                        <p class="font-medium mb-2">要求：</p>
                                        <ul class="list-disc pl-5 text-gray-700 space-y-1">
                                            <li>函数名：buzzerBeep</li>
                                            <li>参数1：频率（Hz），控制蜂鸣器的音调</li>
                                            <li>参数2：持续时间（ms），控制蜂鸣器响多久</li>
                                            <li>提示：通过控制IO口高低电平的切换频率来产生不同音调</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="w-full md:w-1/2">
                                    <div class="comic-border bg-white p-4 h-full flex flex-col justify-center">
                                        <div class="comic-speech">
                                            <p class="text-sm">提示：蜂鸣器的音调由高低电平切换速度决定，切换越快，音调越高！</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 蜂鸣器模拟演示 -->
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6">
                                <h4 class="font-medium mb-3">蜂鸣器效果模拟</h4>
                                <div class="flex flex-wrap gap-4 justify-center items-center">
                                    <div>
                                        <label for="buzzer-freq">频率：</label>
                                        <input type="range" id="buzzer-freq" min="200" max="5000" value="1000" class="w-40">
                                        <span id="freq-value">1000</span> Hz
                                    </div>
                                    
                                    <div>
                                        <label for="buzzer-duration">持续时间：</label>
                                        <input type="range" id="buzzer-duration" min="100" max="2000" value="500" class="w-40">
                                        <span id="duration-value">500</span> ms
                                    </div>
                                    
                                    <div>
                                        <button id="test-buzzer" class="bg-primary text-white px-4 py-2 rounded text-sm">
                                            测试声音
                                        </button>
                                    </div>
                                </div>
                                <div class="mt-4 flex justify-center">
                                    <div class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center" id="buzzer-animation">
                                        <i class="fa fa-volume-up text-gray-500 text-2xl"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6">
                                <button class="show-answer bg-primary/10 text-primary px-4 py-2 rounded hover:bg-primary/20 transition-colors" data-answer="answer1">
                                    查看答案
                                </button>
                                
                                <div id="answer1" class="hidden mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                                    <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm mb-4">
                                        <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                        <pre><span class="text-green-400">// 蜂鸣器控制函数：让蜂鸣器以指定频率响指定时间</span>
<span class="text-green-400">// freq: 频率(Hz)，duration: 持续时间(ms)</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">buzzerBeep</span>(<span class="text-yellow-300">unsigned int</span> freq, <span class="text-yellow-300">unsigned int</span> duration)
{
    <span class="text-yellow-300">unsigned long</span> totalCycles; <span class="text-green-400">// 总周期数</span>
    <span class="text-yellow-300">unsigned int</span> halfPeriod; <span class="text-green-400">// 半周期时间(us)</span>
    <span class="text-yellow-300">unsigned long</span> i;
    
    <span class="text-green-400">// 计算半周期时间(微秒)，1秒=1e6微秒</span>
    halfPeriod = 500000 / freq;
    
    <span class="text-green-400">// 计算总周期数：总时间(ms) * 频率(Hz) / 1000</span>
    totalCycles = (unsigned long)duration * freq / 1000;
    
    <span class="text-green-400">// 循环产生指定频率的方波</span>
    <span class="text-orange-300">for</span>(i = 0; i < totalCycles; i++)
    {
        P3_7 = 1; <span class="text-green-400">// 蜂鸣器端口置高</span>
        <span class="text-green-400">// 延时halfPeriod微秒（需要实现微秒级延时函数）</span>
        delayUs(halfPeriod);
        
        P3_7 = 0; <span class="text-green-400">// 蜂鸣器端口置低</span>
        delayUs(halfPeriod);
    }
    
    P3_7 = 0; <span class="text-green-400">// 确保最后蜂鸣器是关闭状态</span>
}

<span class="text-green-400">// 微秒级延时函数（简化版）</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayUs</span>(<span class="text-yellow-300">unsigned int</span> us)
{
    <span class="text-orange-300">while</span>(us--); <span class="text-green-400">// 实际需要根据主频校准</span>
}

<span class="text-green-400">// 调用示例</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">main</span>(<span class="text-yellow-300">void</span>)
{
    <span class="text-orange-300">while</span>(1)
    {
        buzzerBeep(1000, 500); <span class="text-green-400">// 1000Hz响500ms</span>
        delayMs(1000); <span class="text-green-400">// 停1秒</span>
        buzzerBeep(2000, 500); <span class="text-green-400">// 2000Hz响500ms</span>
        delayMs(1000); <span class="text-green-400">// 停1秒</span>
    }
}</pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 练习2 -->
                    <div class="mb-8 border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-light px-6 py-4 flex justify-between items-center cursor-pointer practice-header" data-target="practice2">
                            <h3 class="font-semibold text-lg">练习2：编写一个按键处理函数</h3>
                            <i class="fa fa-chevron-down text-primary transition-transform duration-300"></i>
                        </div>
                        <div id="practice2" class="hidden p-6 border-t border-gray-200">
                            <p class="text-gray-600 mb-4">
                                任务：编写一个按键处理函数，实现按键的消抖并返回按键状态。
                            </p>
                            <div class="bg-light p-4 rounded-lg mb-4">
                                <p class="font-medium mb-2">要求：</p>
                                <ul class="list-disc pl-5 text-gray-700 space-y-1">
                                    <li>函数名：getKeyState</li>
                                    <li>参数：按键对应的IO口和位（如P3, 2表示P3.2口）</li>
                                    <li>返回值：1表示按键按下，0表示按键未按下</li>
                                    <li>功能：实现按键消抖，只有当按键状态稳定时才返回结果</li>
                                </ul>
                            </div>
                            
                            <!-- 按键交互演示 -->
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6">
                                <h4 class="font-medium mb-3">按键消抖演示</h4>
                                <div class="flex flex-col md:flex-row gap-6 items-center justify-center">
                                    <div class="text-center">
                                        <div id="virtual-button" class="w-24 h-12 bg-gray-200 rounded flex items-center justify-center cursor-pointer border-2 border-gray-300 transform transition-transform hover:scale-105 active:scale-95">
                                            <span>按键</span>
                                        </div>
                                        <p class="text-sm mt-2">点击上面的按键</p>
                                    </div>
                                    
                                    <div class="w-32 h-32 bg-white rounded-full flex flex-col items-center justify-center border border-gray-300">
                                        <p class="text-sm mb-1">按键状态</p>
                                        <p class="text-xl font-bold text-gray-500" id="button-state">未按下</p>
                                    </div>
                                    
                                    <div class="w-32 h-32 bg-white rounded-full flex flex-col items-center justify-center border border-gray-300">
                                        <p class="text-sm mb-1">消抖后状态</p>
                                        <p class="text-xl font-bold text-gray-500" id="debounced-state">未按下</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6">
                                <button class="show-answer bg-primary/10 text-primary px-4 py-2 rounded hover:bg-primary/20 transition-colors" data-answer="answer2">
                                    查看答案
                                </button>
                                
                                <div id="answer2" class="hidden mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                                    <div class="code-block bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm mb-4">
                                        <button class="copy-btn bg-gray-700 text-white px-2 py-1 rounded text-xs" onclick="copyCode(this)">复制</button>
                                        <pre><span class="text-green-400">// 函数声明</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayMs</span>(<span class="text-yellow-300">unsigned int</span> ms);
<span class="text-yellow-300">bit</span> <span class="text-blue-300">getKeyState</span>(<span class="text-yellow-300">sfr</span> port, <span class="text-yellow-300">unsigned char</span> bitNum);

<span class="text-green-400">// 延时函数</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">delayMs</span>(<span class="text-yellow-300">unsigned int</span> ms)
{
    <span class="text-yellow-300">unsigned int</span> i, j;
    <span class="text-orange-300">for</span>(i = 0; i < ms; i++)
        <span class="text-orange-300">for</span>(j = 0; j < 112; j++);
}

<span class="text-green-400">// 按键状态获取函数（带消抖）</span>
<span class="text-green-400">// port: 按键所在端口，bitNum: 按键所在位(0-7)</span>
<span class="text-green-400">// 返回值：1-按下，0-未按下</span>
<span class="text-yellow-300">bit</span> <span class="text-blue-300">getKeyState</span>(<span class="text-yellow-300">sfr</span> port, <span class="text-yellow-300">unsigned char</span> bitNum)
{
    <span class="text-yellow-300">bit</span> firstState, secondState;
    
    <span class="text-green-400">// 第一次读取按键状态</span>
    firstState = (port & (1 << bitNum)) ? 0 : 1;
    
    <span class="text-green-400">// 如果第一次读取是按下状态，进行消抖确认</span>
    <span class="text-orange-300">if</span>(firstState)
    {
        delayMs(10); <span class="text-green-400">// 延时10ms消抖</span>
        
        <span class="text-green-400">// 第二次读取按键状态</span>
        secondState = (port & (1 << bitNum)) ? 0 : 1;
        
        <span class="text-green-400">// 两次都为按下状态，才确认是真的按下</span>
        <span class="text-orange-300">if</span>(secondState)
            <span class="text-orange-300">return</span> 1; <span class="text-green-400">// 按键按下</span>
    }
    
    <span class="text-orange-300">return</span> 0; <span class="text-green-400">// 按键未按下</span>
}

<span class="text-green-400">// 主函数中使用</span>
<span class="text-yellow-300">void</span> <span class="text-blue-300">main</span>(<span class="text-yellow-300">void</span>)
{
    P1 = 0xFF; <span class="text-green-400">// 初始化LED为灭</span>
    
    <span class="text-orange-300">while</span>(1)
    {
        <span class="text-green-400">// 检测P3.2口的按键状态</span>
        <span class="text-orange-300">if</span>(getKeyState(P3, 2))
        {
            P1 = 0x00; <span class="text-green-400">// 按键按下，点亮所有LED</span>
        }
        <span class="text-orange-300">else</span>
        {
            P1 = 0xFF; <span class="text-green-400">// 按键未按下，熄灭所有LED</span>
        }
    }
}</pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 常见问题 -->
        <section id="faq" class="mb-20 scroll-mt-24">
            <div class="max-w-4xl mx-auto">
                <div class="flex items-center mb-6">
                    <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center mr-4">
                        <i class="fa fa-question-circle text-primary text-xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold">常见问题</h2>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-8">
                    <div class="space-y-6">
                        <div class="border border-gray-200 rounded-lg overflow-hidden">
                            <div class="bg-light px-6 py-4 cursor-pointer faq-header" data-target="faq1">
                                <h3 class="font-semibold">函数名可以随便取吗？有什么规则？</h3>
                            </div>
                            <div id="faq1" class="hidden p-6 border-t border-gray-200">
                                <p class="text-gray-600">
                                    函数名不能随便取，需要遵循C语言的标识符命名规则：
                                </p>
                                <ul class="list-disc pl-5 text-gray-600 mt-2 space-y-1">
                                    <li>只能由字母、数字和下划线组成</li>
                                    <li>不能以数字开头</li>
                                    <li>不能使用C语言的关键字（如int、void、for等）</li>
                                    <li>区分大小写（如LedBlink和ledblink是不同的函数名）</li>
                                </ul>
                                <p class="text-gray-600 mt-3">
                                    建议函数名使用有意义的名称，能够体现函数的功能，例如控制LED闪烁的函数可以命名为ledBlink，延时函数可以命名为delayMs等。
                                </p>
                            </div>
                        </div>
                        
                        <div class="border border-gray-200 rounded-lg overflow-hidden">
                            <div class="bg-light px-6 py-4 cursor-pointer faq-header" data-target="faq2">
                                <h3 class="font-semibold">为什么函数要先声明后使用？</h3>
                            </div>
                            <div id="faq2" class="hidden p-6 border-t border-gray-200">
                                <p class="text-gray-600">
                                    C语言编译器是从上到下依次编译代码的。当编译器遇到一个函数调用时，需要知道这个函数的返回值类型和参数信息，否则会报错。
                                </p>
                                <p class="text-gray-600 mt-2">
                                    函数声明就像是给编译器一张"名片"，告诉编译器有这么一个函数存在，以及它的返回值类型和参数情况。这样当编译器在后面遇到函数调用时，就能正确识别和处理了。
                                </p>
                                <p class="text-gray-600 mt-2">
                                    另一种方式是将函数定义写在调用它的函数之前，这样也可以不用单独声明，因为编译器已经先看到了完整的函数定义。
                                </p>
                            </div>
                        </div>
                        
                        <div class="border border-gray-200 rounded-lg overflow-hidden">
                            <div class="bg-light px-6 py-4 cursor-pointer faq-header" data-target="faq3">
                                <h3 class="font-semibold">51单片机中函数可以嵌套调用吗？可以递归调用吗？</h3>
                            </div>
                            <div id="faq3" class="hidden p-6 border-t border-gray-200">
                                <p class="text-gray-600 mb-2">
                                    <strong>嵌套调用：</strong> 可以。函数的嵌套调用是指在一个函数内部调用另一个函数，这在51单片机编程中非常常见。例如：
                                </p>
                                <div class="bg-gray-50 p-3 rounded text-sm font-mono mb-4">
                                    void funcA() { ... }<br>
                                    void funcB() { funcA(); }<br>
                                    void main() { funcB(); }
                                </div>
                                <p class="text-gray-600 mb-2">
                                    <strong>递归调用：</strong> 理论上可以，但不推荐在51单片机中使用。递归调用是指函数调用自身，这需要单片机有足够的栈空间来保存每次调用的上下文。
                                </p>
                                <p class="text-gray-600">
                                    由于51单片机的RAM资源通常比较有限（一般只有128字节或256字节），递归调用很容易导致栈溢出，造成程序崩溃。因此，在51单片机编程中，建议用循环代替递归。
                                </p>
                            </div>
                        </div>
                        
                        <div class="border border-gray-200 rounded-lg overflow-hidden">
                            <div class="bg-light px-6 py-4 cursor-pointer faq-header" data-target="faq4">
                                <h3 class="font-semibold">函数参数可以有多个吗？最多可以有多少个？</h3>
                            </div>
                            <div id="faq4" class="hidden p-6 border-t border-gray-200">
                                <p class="text-gray-600">
                                    函数可以有多个参数，多个参数之间用逗号分隔。例如：
                                </p>
                                <div class="bg-gray-50 p-3 rounded text-sm font-mono mb-4">
                                    void setLedState(unsigned char ledNum, bit state, unsigned int delayTime) { ... }
                                </div>
                                <p class="text-gray-600">
                                    C语言标准并没有严格限制函数参数的数量，但在实际编程中，参数数量不宜过多（一般不超过5-6个），否则会降低代码的可读性。
                                </p>
                                <p class="text-gray-600 mt-2">
                                    如果需要传递多个相关的数据，可以考虑将这些数据组织成结构体，然后传递结构体变量或结构体指针作为参数。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-12">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto">
                <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                    <div class="flex items-center mb-6 md:mb-0">
                        <i class="fa fa-microchip text-primary text-2xl mr-2"></i>
                        <h2 class="text-xl font-bold">51单片机函数学习</h2>
                    </div>
                    <div class="flex space-x-4">
                        <a href="#" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fa fa-github"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fa fa-youtube-play"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fa fa-reddit"></i>
                        </a>
                    </div>
                </div>
                
                <div class="border-t border-white/10 pt-8 mt-8 text-center text-gray-400 text-sm">
                    <p>© 2023 51单片机学习指南 | 嵌入式工程师精心打造</p>
                    <p class="mt-2">本网站仅供学习交流使用，转载请注明出处</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- 返回顶部按钮 -->
    <button id="back-to-top" class="fixed bottom-8 right-8 w-12 h-12 rounded-full bg-primary text-white shadow-lg flex items-center justify-center opacity-0 invisible transition-all duration-300 hover:bg-primary/90">
        <i class="fa fa-arrow-up"></i>
    </button>

    <script>
        // 确保DOM加载完成后执行所有JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            // 移动端菜单切换
            document.getElementById('menu-toggle').addEventListener('click', function() {
                const mobileMenu = document.getElementById('mobile-menu');
                mobileMenu.classList.toggle('hidden');
            });
            
            // 导航栏滚动效果
            window.addEventListener('scroll', function() {
                const navbar = document.getElementById('navbar');
                const backToTop = document.getElementById('back-to-top');
                
                if (window.scrollY > 100) {
                    navbar.classList.add('py-2', 'shadow');
                    navbar.classList.remove('py-3');
                    
                    backToTop.classList.remove('opacity-0', 'invisible');
                    backToTop.classList.add('opacity-100', 'visible');
                } else {
                    navbar.classList.add('py-3');
                    navbar.classList.remove('py-2', 'shadow');
                    
                    backToTop.classList.add('opacity-0', 'invisible');
                    backToTop.classList.remove('opacity-100', 'visible');
                }
            });
            
            // 返回顶部功能
            document.getElementById('back-to-top').addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // 实例代码展开/折叠
            document.querySelectorAll('.example-header').forEach(header => {
                header.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const targetElement = document.getElementById(targetId);
                    const icon = this.querySelector('i');
                    
                    targetElement.classList.toggle('hidden');
                    icon.classList.toggle('rotate-180');
                    
                    // 添加淡入动画
                    if (!targetElement.classList.contains('hidden')) {
                        targetElement.classList.add('fade-in');
                        setTimeout(() => {
                            targetElement.classList.remove('fade-in');
                        }, 500);
                    }
                });
            });
            
            // 练习题展开/折叠
            document.querySelectorAll('.practice-header').forEach(header => {
                header.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const targetElement = document.getElementById(targetId);
                    const icon = this.querySelector('i');
                    
                    targetElement.classList.toggle('hidden');
                    icon.classList.toggle('rotate-180');
                    
                    // 添加淡入动画
                    if (!targetElement.classList.contains('hidden')) {
                        targetElement.classList.add('fade-in');
                        setTimeout(() => {
                            targetElement.classList.remove('fade-in');
                        }, 500);
                    }
                });
            });
            
            // 常见问题展开/折叠
            document.querySelectorAll('.faq-header').forEach(header => {
                header.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const targetElement = document.getElementById(targetId);
                    
                    targetElement.classList.toggle('hidden');
                    
                    // 添加淡入动画
                    if (!targetElement.classList.contains('hidden')) {
                        targetElement.classList.add('fade-in');
                        setTimeout(() => {
                            targetElement.classList.remove('fade-in');
                        }, 500);
                    }
                });
            });
            
            // 显示答案
            document.querySelectorAll('.show-answer').forEach(button => {
                button.addEventListener('click', function() {
                    const answerId = this.getAttribute('data-answer');
                    const answerElement = document.getElementById(answerId);
                    
                    answerElement.classList.toggle('hidden');
                    
                    if (!answerElement.classList.contains('hidden')) {
                        answerElement.classList.add('fade-in');
                        setTimeout(() => {
                            answerElement.classList.remove('fade-in');
                        }, 500);
                        
                        // 滚动到答案位置
                        answerElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'nearest'
                        });
                    }
                });
            });
            
            // 复制代码功能
            function copyCode(button) {
                const codeBlock = button.nextElementSibling;
                const textToCopy = codeBlock.textContent;
                
                navigator.clipboard.writeText(textToCopy).then(() => {
                    const originalText = button.textContent;
                    button.textContent = '已复制';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                    }, 2000);
                });
            }
            
            // 函数工作原理演示
            let demoInterval;
            document.getElementById('start-demo').addEventListener('click', function() {
                const mainProgram = document.getElementById('main-program');
                const functionBox = document.getElementById('function-box');
                const demoStatus = document.getElementById('demo-status');
                const leds = [
                    document.getElementById('led1'),
                    document.getElementById('led2'),
                    document.getElementById('led3')
                ];
                
                // 重置状态
                clearInterval(demoInterval);
                leds.forEach(led => led.classList.remove('on'));
                mainProgram.classList.remove('bg-primary');
                mainProgram.classList.add('bg-gray-100');
                functionBox.classList.remove('bg-primary');
                functionBox.classList.add('bg-primary/10');
                
                // 开始演示
                demoStatus.textContent = '主程序开始执行...';
                
                setTimeout(() => {
                    demoStatus.textContent = '主程序需要LED闪烁3次，准备调用ledBlink(3)函数...';
                    mainProgram.classList.remove('bg-gray-100');
                    mainProgram.classList.add('bg-primary');
                    
                    setTimeout(() => {
                        demoStatus.textContent = '调用ledBlink(3)函数，程序跳转到函数执行...';
                        mainProgram.classList.remove('bg-primary');
                        mainProgram.classList.add('bg-gray-100');
                        functionBox.classList.remove('bg-primary/10');
                        functionBox.classList.add('bg-primary');
                        
                        let count = 0;
                        demoInterval = setInterval(() => {
                            if (count < 3) {
                                // 点亮LED
                                leds[count].classList.add('on');
                                demoStatus.textContent = `函数执行中：第${count+1}次闪烁 - LED亮`;
                                
                                setTimeout(() => {
                                    // 熄灭LED
                                    leds[count].classList.remove('on');
                                    demoStatus.textContent = `函数执行中：第${count+1}次闪烁 - LED灭`;
                                    count++;
                                    
                                    // 全部完成
                                    if (count >= 3) {
                                        clearInterval(demoInterval);
                                        demoStatus.textContent = '函数执行完成，返回主程序...';
                                        
                                        setTimeout(() => {
                                            functionBox.classList.remove('bg-primary');
                                            functionBox.classList.add('bg-primary/10');
                                            mainProgram.classList.remove('bg-gray-100');
                                            mainProgram.classList.add('bg-primary');
                                            
                                            setTimeout(() => {
                                                demoStatus.textContent = '回到主程序，继续执行后续代码';
                                                mainProgram.classList.remove('bg-primary');
                                                mainProgram.classList.add('bg-gray-100');
                                            }, 1000);
                                        }, 1000);
                                    }
                                }, 500);
                            }
                        }, 1000);
                    }, 1500);
                }, 1000);
            });
            
            // 函数结构部分说明
            const partExplanations = {
                'return-type': '返回值类型：函数执行完后返回的数据类型，如int（整数）、float（浮点数）等。如果没有返回值，用void表示。',
                'name': '函数名：给函数起的名字，应遵循标识符规则并能体现函数功能，如ledBlink、delayMs。',
                'parameters': '参数列表：函数需要的输入数据，格式为"类型 参数名"，多个参数用逗号分隔。无参数可写void或空着。',
                'body': '函数体：用大括号{}包裹的代码块，包含了实现函数功能的具体语句。',
                'return': 'return语句：将结果返回给调用者，后面跟要返回的值。返回值类型为void时可省略。'
            };
            
            document.querySelectorAll('.function-part').forEach(part => {
                part.addEventListener('click', function() {
                    const partName = this.getAttribute('data-part');
                    document.getElementById('part-explanation').textContent = partExplanations[partName];
                    
                    // 高亮当前选中部分
                    document.querySelectorAll('.function-part').forEach(p => {
                        p.classList.remove('bg-primary/10', 'border-primary');
                        p.classList.add('border-gray-200');
                    });
                    this.classList.remove('border-gray-200');
                    this.classList.add('bg-primary/10', 'border-primary');
                });
            });
            
            // 步骤导航
            let currentStep = 1;
            const totalSteps = 3;
            
            document.getElementById('next-step').addEventListener('click', function() {
                if (currentStep < totalSteps) {
                    // 隐藏当前步骤
                    document.getElementById(`step-${currentStep}`).classList.add('hidden');
                    document.querySelector(`.step-circle[data-step="${currentStep}"]`).classList.remove('bg-primary', 'text-white');
                    document.querySelector(`.step-circle[data-step="${currentStep}"]`).classList.add('bg-gray-200', 'text-gray-600');
                    
                    // 显示下一步
                    currentStep++;
                    document.getElementById(`step-${currentStep}`).classList.remove('hidden');
                    document.querySelector(`.step-circle[data-step="${currentStep}"]`).classList.remove('bg-gray-200', 'text-gray-600');
                    document.querySelector(`.step-circle[data-step="${currentStep}"]`).classList.add('bg-primary', 'text-white');
                    
                    // 更新按钮状态
                    document.getElementById('prev-step').disabled = false;
                    if (currentStep === totalSteps) {
                        this.disabled = true;
                    }
                }
            });
            
            document.getElementById('prev-step').addEventListener('click', function() {
                if (currentStep > 1) {
                    // 隐藏当前步骤
                    document.getElementById(`step-${currentStep}`).classList.add('hidden');
                    document.querySelector(`.step-circle[data-step="${currentStep}"]`).classList.remove('bg-primary', 'text-white');
                    document.querySelector(`.step-circle[data-step="${currentStep}"]`).classList.add('bg-gray-200', 'text-gray-600');
                    
                    // 显示上一步
                    currentStep--;
                    document.getElementById(`step-${currentStep}`).classList.remove('hidden');
                    document.querySelector(`.step-circle[data-step="${currentStep}"]`).classList.remove('bg-gray-200', 'text-gray-600');
                    document.querySelector(`.step-circle[data-step="${currentStep}"]`).classList.add('bg-primary', 'text-white');
                    
                    // 更新按钮状态
                    document.getElementById('next-step').disabled = false;
                    if (currentStep === 1) {
                        this.disabled = true;
                    }
                }
            });
            
            // 函数调用动画
            document.getElementById('animate-call').addEventListener('click', function() {
                const callArrow = document.getElementById('call-arrow');
                const returnArrow = document.getElementById('return-arrow');
                
                // 重置状态
                callArrow.classList.add('hidden');
                returnArrow.classList.add('hidden');
                
                // 调用动画
                setTimeout(() => {
                    callArrow.classList.remove('hidden');
                    callArrow.classList.add('fade-in');
                    
                    setTimeout(() => {
                        callArrow.classList.add('hidden');
                        
                        // 执行函数（延迟模拟）
                        setTimeout(() => {
                            // 返回动画
                            returnArrow.classList.remove('hidden');
                            returnArrow.classList.add('fade-in');
                            
                            setTimeout(() => {
                                returnArrow.classList.add('hidden');
                            }, 1000);
                        }, 1000);
                    }, 1000);
                }, 300);
            });
            
            // 代码分步讲解
            let currentCodeStep = 0;
            const totalCodeSteps = 5;
            
            document.getElementById('next-code-1').addEventListener('click', function() {
                if (currentCodeStep < totalCodeSteps) {
                    currentCodeStep++;
                    updateCodeDemo();
                }
            });
            
            document.getElementById('prev-code-1').addEventListener('click', function() {
                if (currentCodeStep > 0) {
                    currentCodeStep--;
                    updateCodeDemo();
                }
            });
            
            function updateCodeDemo() {
                // 更新代码步骤显示
                document.querySelectorAll('.code-step').forEach((step, index) => {
                    if (index + 1 <= currentCodeStep) {
                        step.classList.add('active');
                    } else {
                        step.classList.remove('active');
                    }
                });
                
                // 更新说明文本
                const explanations = [
                    "点击"下一步"开始查看代码分步讲解",
                    "1. 首先声明delayMs函数，告诉编译器这个函数的存在及其参数和返回值类型",
                    "2. 然后定义delayMs函数，这是函数的具体实现部分",
                    "3. 使用双重for循环实现延时功能，外层循环控制总毫秒数，内层循环实现大约1ms的延时",
                    "4. 在main函数中，我们使用while(1)创建一个无限循环，让程序持续运行",
                    "5. 在循环中，我们控制P1口输出高低电平来控制LED的亮灭，并使用delayMs函数控制亮灭时间"
                ];
                
                document.getElementById('code-explanation-1').textContent = explanations[currentCodeStep];
                
                // 更新按钮状态
                document.getElementById('prev-code-1').disabled = currentCodeStep === 0;
                document.getElementById('next-code-1').disabled = currentCodeStep === totalCodeSteps;
            }
            
            // 延时函数演示
            let delayDemoInterval;
            document.getElementById('start-delay-demo').addEventListener('click', function() {
                const demoLed = document.getElementById('demo-led-1');
                const delayTime = document.getElementById('delay-time').value;
                
                // 停止当前演示
                clearInterval(delayDemoInterval);
                
                // 开始新演示
                let isOn = false;
                demoLed.classList.remove('on');
                
                delayDemoInterval = setInterval(() => {
                    isOn = !isOn;
                    if (isOn) {
                        demoLed.classList.add('on');
                    } else {
                        demoLed.classList.remove('on');
                    }
                }, delayTime);
            });
            
            // 显示延时值
            document.getElementById('delay-time').addEventListener('input', function() {
                document.getElementById('delay-value').textContent = this.value;
            });
            
            // LED控制演示
            document.getElementById('led-on').addEventListener('click', function() {
                const ledNum = document.getElementById('led-select').value;
                document.getElementById(`led-${ledNum}`).classList.add('on');
            });
            
            document.getElementById('led-off').addEventListener('click', function() {
                const ledNum = document.getElementById('led-select').value;
                document.getElementById(`led-${ledNum}`).classList.remove('on');
            });
            
            let sequenceInterval;
            document.getElementById('led-sequence').addEventListener('click', function() {
                // 停止当前序列
                clearInterval(sequenceInterval);
                
                // 关闭所有LED
                for (let i = 0; i < 8; i++) {
                    document.getElementById(`led-${i}`).classList.remove('on');
                }
                
                // 开始流水灯
                let currentLed = 0;
                sequenceInterval = setInterval(() => {
                    // 关闭上一个LED
                    if (currentLed > 0) {
                        document.getElementById(`led-${currentLed - 1}`).classList.remove('on');
                    } else {
                        document.getElementById('led-7').classList.remove('on');
                    }
                    
                    // 点亮当前LED
                    document.getElementById(`led-${currentLed}`).classList.add('on');
                    
                    // 更新当前LED索引
                    currentLed = (currentLed + 1) % 8;
                }, 200);
            });
            
            // 温度转换演示
            document.getElementById('convert-btn').addEventListener('click', function() {
                const celsius = parseFloat(document.getElementById('celsius-input').value);
                const fahrenheit = (celsius * 9 / 5 + 32).toFixed(1);
                
                // 添加转换动画效果
                const resultElement = document.getElementById('fahrenheit-result');
                resultElement.classList.add('pulse');
                
                setTimeout(() => {
                    resultElement.textContent = `${fahrenheit} °F`;
                    resultElement.classList.remove('pulse');
                }, 500);
            });
            
            // 蜂鸣器演示
            document.getElementById('buzzer-freq').addEventListener('input', function() {
                document.getElementById('freq-value').textContent = this.value;
            });
            
            document.getElementById('buzzer-duration').addEventListener('input', function() {
                document.getElementById('duration-value').textContent = this.value;
            });
            
            document.getElementById('test-buzzer').addEventListener('click', function() {
                const freq = parseInt(document.getElementById('buzzer-freq').value);
                const duration = parseInt(document.getElementById('buzzer-duration').value);
                const buzzerAnimation = document.getElementById('buzzer-animation');
                
                // 动画效果
                buzzerAnimation.classList.add('bg-primary/20');
                buzzerAnimation.querySelector('i').classList.add('text-primary');
                
                // 简单的声音模拟
                try {
                    // 创建音频上下文
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.type = 'square';
                    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.start();
                    
                    // 持续指定时间后停止
                    setTimeout(() => {
                        oscillator.stop();
                        buzzerAnimation.classList.remove('bg-primary/20');
                        buzzerAnimation.querySelector('i').classList.remove('text-primary');
                    }, duration);
                } catch (e) {
                    console.log('浏览器不支持音频播放');
                    // 仅显示动画
                    setTimeout(() => {
                        buzzerAnimation.classList.remove('bg-primary/20');
                        buzzerAnimation.querySelector('i').classList.remove('text-primary');
                    }, duration);
                }
            });
            
            // 按键消抖演示
            let debounceTimer;
            document.getElementById('virtual-button').addEventListener('mousedown', function() {
                document.getElementById('button-state').textContent = '按下';
                document.getElementById('button-state').classList.remove('text-gray-500');
                document.getElementById('button-state').classList.add('text-green-500');
                
                // 模拟按键抖动
                const randomJitter = Math.random() > 0.5;
                if (randomJitter) {
                    setTimeout(() => {
                        if (document.getElementById('button-state').textContent === '按下') {
                            document.getElementById('button-state').textContent = '抖动';
                            document.getElementById('button-state').classList.remove('text-green-500');
                            document.getElementById('button-state').classList.add('text-yellow-500');
                            
                            setTimeout(() => {
                                if (document.getElementById('button-state').textContent === '抖动') {
                                    document.getElementById('button-state').textContent = '按下';
                                    document.getElementById('button-state').classList.remove('text-yellow-500');
                                    document.getElementById('button-state').classList.add('text-green-500');
                                }
                            }, 50);
                        }
                    }, 30);
                }
                
                // 消抖处理
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    document.getElementById('debounced-state').textContent = '按下';
                    document.getElementById('debounced-state').classList.remove('text-gray-500');
                    document.getElementById('debounced-state').classList.add('text-green-500');
                }, 50); // 50ms消抖时间
            });
            
            document.getElementById('virtual-button').addEventListener('mouseup', function() {
                document.getElementById('button-state').textContent = '未按下';
                document.getElementById('button-state').classList.remove('text-green-500', 'text-yellow-500');
                document.getElementById('button-state').classList.add('text-gray-500');
                
                // 消抖处理
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    document.getElementById('debounced-state').textContent = '未按下';
                    document.getElementById('debounced-state').classList.remove('text-green-500');
                    document.getElementById('debounced-state').classList.add('text-gray-500');
                }, 50); // 50ms消抖时间
            });
            
            // 默认展开第一个实例
            const firstExample = document.querySelector('.example-header');
            if (firstExample) {
                firstExample.click();
            }
        });
    </script>
</body>
</html>
